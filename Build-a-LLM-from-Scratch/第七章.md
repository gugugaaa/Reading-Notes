å¾®è°ƒæ¥æŽ¥æ”¶æŒ‡ä»¤
---

![alt text](images/build-a-llm/image_rename59.png)
ç›®æ ‡æ˜¯ä»Žprompt+inputï¼Œä»Žpromptçš„ç¬¬ä¸€ä¸ªè¯å¼€å§‹ä¸€ä¸ªä¸€ä¸ªtokenåœ°é¢„æµ‹ï¼Œæœ€åŽæå–å‡ºoutput(è‡ªå›žå½’)

è®©æ¨¡åž‹â€œå¬æ‡‚â€æŒ‡ä»¤ï¼Œç„¶åŽæ‰§è¡ŒæŒ‡ä»¤

![alt text](images/build-a-llm/image_rename54.png)
*è®­ç»ƒæŒ‡ä»¤å¾®è°ƒçš„ä¸‰ä¸ªæ­¥éª¤ï¼šå‡†å¤‡æ•°æ®ï¼Œå¾®è°ƒæ¨¡åž‹ï¼Œè¯„ä¼°æ¨¡åž‹*

### é˜¶æ®µä¸€ï¼šå‡†å¤‡æŒ‡ä»¤æ•°æ®é›†
#### 1. æ•°æ®é›†
ç”±instruction + input -> outputç»„æˆ


```
Example entry: 
{'instruction': "What is an antonym of 'complicated'?", 
'input': '', 
'output': "An antonym of 'complicated' is 'simple'."}
```
*æ•°æ®é•¿è¿™æ ·ã€‚inputä¹Ÿå¯ä»¥ä¸ºç©º*

##### è½¬æ¢Prompté£Žæ ¼ï¼ˆé¢„å¤„ç†ï¼‰
![alt text](images/build-a-llm/image_rename55.png)
ä¸ºäº†é€‚é…å·²æœ‰çš„å¾®è°ƒæ¡†æž¶ï¼Œè®©æŽ¨ç†æ•ˆæžœæ›´ç¨³å®šï¼Œæˆ‘ä»¬ä¼šè½¬æ¢æˆç‰¹å®šPrompt Styleä¾‹å¦‚Alpacaæˆ–è€…Phi-3

##### åˆ’åˆ†æ•°æ®é›†

#### 2. æ•°æ®åŠ è½½å™¨
##### è‡ªåˆ¶æ•°æ®åŠ è½½å™¨
![alt text](images/build-a-llm/image_rename56.png)
*æ­¥éª¤*ï¼š
æ”¹ç”¨Promptæ¨¡æ¿ â†’ åˆ†è¯  â†’ æŠŠå¥å­Paddingåˆ°ç›¸åŒé•¿åº¦ â†’ åˆ›å»ºç›®æ ‡å‘é‡ â†’ å¯¹é½

![alt text](images/build-a-llm/image_rename57.png)
*åœ¨è®¡ç®—æŸå¤±æ—¶ï¼Œé€šè¿‡æŽ©è†œæŠŠæŒ‡ä»¤å’Œè¾“å…¥çš„token id è®¾ç½®ä¸º-100ï¼Œåªä¼šç»Ÿè®¡è¾“å‡ºçš„æŸå¤±*

> å¯¹äºŽåœ¨æŒ‡ä»¤å¾®è°ƒè¿‡ç¨‹ä¸­å±è”½æŒ‡ä»¤æ˜¯å¦æ™®éæœ‰ç›Šï¼Œè¿˜å­˜åœ¨åˆ†æ­§

#### 3. åˆ©ç”¨æ•°æ®åŠ è½½å™¨å®žçŽ°æ‰¹å¤„ç†
(ç•¥)

### é˜¶æ®µäºŒï¼šå¾®è°ƒæ¨¡åž‹
#### 4. åŠ è½½é¢„è®­ç»ƒæ¨¡åž‹
ä½¿ç”¨"gpt2-medium (355M)"

#### 5. åœ¨æŒ‡ä»¤æ•°æ®é›†ä¸Šå¾®è°ƒæ¨¡åž‹

### é˜¶æ®µä¸‰ï¼šè¯„ä¼°æ¨¡åž‹
![alt text](images/build-a-llm/image_rename58.png)

#### 6. æå–æ¨¡åž‹çš„å“åº”
(ç•¥)

#### 7. è¯„ä¼°æ¨¡åž‹çš„æ€§èƒ½
è¯„ä»·æ–¹æ³•ï¼š
- ç®€ç­”é¢˜å’Œå¤šé€‰é¢˜çš„å‡†ç¡®çŽ‡ï¼šæµ‹è¯•ä¸€èˆ¬çŸ¥è¯†
- äººç±»åå¥½ä¸Žå…¶ä»–LLMçš„æ¯”è¾ƒï¼šæµ‹è¯•æŒ‡ä»¤ç†è§£èƒ½åŠ›
- è‡ªåŠ¨ä¼šè¯åŸºå‡†ï¼šæµ‹è¯•æ¨¡åž‹çš„å¯¹è¯èƒ½åŠ›

> äººç±»è¯„ä¼°ï¼šæ•°æ®å®è´µï¼Œä½†æ•ˆçŽ‡ä½Ž
> - å¸¸è§æ–¹æ³•ï¼šA/Bæµ‹è¯•ï¼Œé‡è¡¨æ‰“åˆ†
> 
> è‡ªåŠ¨è¯„ä¼°ï¼šç”¨ä»£ç è·‘æ ‡å‡†æµ‹è¯•é›†
> - å¸¸è§æ–¹æ³•ï¼šBLEUï¼ŒROUGEï¼ŒPerplexity


### æŒ‡ä»¤å¾®è°ƒè¿‡ç¨‹å°ç»“

#### 1. æ•°æ®å‡†å¤‡
- ä¸‹è½½æŒ‡ä»¤-å“åº”æ•°æ®é›†
- æ ¼å¼åŒ–æ•°æ®æ¡ç›®
- åˆ’åˆ†è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†

#### 2. è®­ç»ƒæ•°æ®å¤„ç†
- ä½¿ç”¨è‡ªå®šä¹‰æ•´ç†å‡½æ•°(custom_collate_fn)æž„å»ºè®­ç»ƒæ‰¹æ¬¡
- å¡«å……åºåˆ—åˆ°ç»Ÿä¸€é•¿åº¦
- åˆ›å»ºç›®æ ‡æ ‡è®°ID
- å¯¹å¡«å……æ ‡è®°è¿›è¡Œå±è”½å¤„ç†

#### 3. æ¨¡åž‹é€‰æ‹©ä¸Žè®­ç»ƒ
- ä½¿ç”¨é¢„è®­ç»ƒçš„GPT-2ä¸­åž‹æ¨¡åž‹(355Må‚æ•°)
- é‡‡ç”¨ä¸Žé¢„è®­ç»ƒç›¸ä¼¼çš„è®­ç»ƒå¾ªçŽ¯
- åœ¨æŒ‡ä»¤æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒ

#### 4. è¯„ä¼°æ–¹æ³•
- åœ¨æµ‹è¯•é›†ä¸Šæå–æ¨¡åž‹å“åº”
- ä½¿ç”¨Ollamaåº”ç”¨ç¨‹åº(8Bå‚æ•°Llamaæ¨¡åž‹)è¿›è¡Œè‡ªåŠ¨è¯„åˆ†
- è®¡ç®—å¹³å‡åˆ†ä»¥é‡åŒ–æ¨¡åž‹æ€§èƒ½

---
## å‚è€ƒèµ„æº

### å­¦ä¹ èµ„æº
- æœºå™¨å­¦ä¹ æœ€æ–°è®ºæ–‡ï¼š[arxiv.org/list/cs.LG/recent](https://arxiv.org/list/cs.LG/recent)
  > åŠæ—¶äº†è§£æœºå™¨å­¦ä¹ é¢†åŸŸçš„å‰æ²¿ç ”ç©¶åŠ¨æ€
- ä½œè€…ä¸ªäººåšå®¢ï¼š[sebastianraschka.com/blog](https://sebastianraschka.com/blog/)
  > èŽ·å–ä½œè€…çš„æœ€æ–°ç ”ç©¶å’Œæ•™ç¨‹

### å®žç”¨å·¥å…·
- [Axolotl](https://github.com/axolotl-ai-cloud/axolotl)
  > å°è£…å¥½çš„LLMåŽå¤„ç†å·¥å…·ï¼Œç®€åŒ–æ¨¡åž‹è®­ç»ƒæµç¨‹ï¼ˆç®€å•ä¸€äº›äº›ï¼‰
- [LitGPT](https://github.com/Lightning-AI/litgpt)
  > åŸºäºŽPyTorch Lightningçš„GPTå®žçŽ°

---
> å®Œç»“æ’’èŠ±ï¼ðŸŽ‰
> ![alt text](images/build-a-llm/image_rename60.png)